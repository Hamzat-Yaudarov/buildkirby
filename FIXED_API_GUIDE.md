# üéÅ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–π API –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ Telegram Star –ø–æ–¥–∞—Ä–∫–æ–≤

## üéØ –ß—Ç–æ –±—ã–ª–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ

–ë–ª–∞–≥–æ–¥–∞—Ä—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ–± API, —Ç–µ–ø–µ—Ä—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è —Å—Ö–µ–º–∞:

### ‚ùå –ë—ã–ª–æ (–Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ):
```python
await self.app.invoke(
    functions.payments.SendStarsForm(  # –ù–ï –°–£–©–ï–°–¢–í–£–ï–¢!
        peer=user_id,
        star_count=amount
    )
)
```

### ‚úÖ –°—Ç–∞–ª–æ (–ø—Ä–∞–≤–∏–ª—å–Ω–æ):
```python
# 1. –ü–æ–ª—É—á–∏—Ç—å –∫–∞—Ç–∞–ª–æ–≥ –ø–æ–¥–∞—Ä–∫–æ–≤
result = await app.invoke(functions.payments.GetStarGifts())

# 2. –°–æ–∑–¥–∞—Ç—å invoice –¥–ª—è –ø–æ–¥–∞—Ä–∫–∞
invoice = InputInvoiceStarGift(user_id=user, gift_id=gift.id)

# 3. –ü–æ–ª—É—á–∏—Ç—å —Ñ–æ—Ä–º—É –ø–ª–∞—Ç–µ–∂–∞
payment_form = await app.invoke(functions.payments.GetPaymentForm(invoice=invoice))

# 4. –û—Ç–ø—Ä–∞–≤–∏—Ç—å —Ñ–æ—Ä–º—É (Telethon: SendStarsFormRequest)
await client(functions.payments.SendStarsFormRequest(
    form_id=payment_form.form_id,
    invoice=invoice
))
```

---

## üöÄ –î–≤–∞ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã—Ö –≤–∞—Ä–∏–∞–Ω—Ç–∞

### –í–ê–†–ò–ê–ù–¢ 1: Pyrogram (userbot-agent-correct.py)
- ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–π API —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ –º–µ—Ç–æ–¥–∞–º–∏
- ‚úÖ –ó–∞–≥—Ä—É–∑–∫–∞ –∫–∞—Ç–∞–ª–æ–≥–∞ –ø–æ–¥–∞—Ä–∫–æ–≤ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ
- ‚úÖ –ü–æ–∏—Å–∫ –ø–æ–¥—Ö–æ–¥—è—â–µ–≥–æ –ø–æ–¥–∞—Ä–∫–∞ –ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É –∑–≤—ë–∑–¥
- ‚úÖ –ü–æ–ª–Ω–∞—è —Å—Ö–µ–º–∞: GetStarGifts ‚Üí GetPaymentForm ‚Üí SendPaymentForm

### –í–ê–†–ò–ê–ù–¢ 2: Telethon (userbot-telethon.py)  
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç **SendStarsFormRequest** (—Ç–æ—á–Ω—ã–π –º–µ—Ç–æ–¥ –∏–∑ –≤–∞—à–µ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏)
- ‚úÖ –ë–æ–ª–µ–µ –ø—Ä–æ—Å—Ç–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è
- ‚úÖ –°–ø–µ—Ü–∏–∞–ª—å–Ω–æ –∑–∞—Ç–æ—á–µ–Ω –ø–æ–¥ Star –ø–æ–¥–∞—Ä–∫–∏

---

## üîß –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫

### –®–∞–≥ 1: –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
```bash
# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –æ–±–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏
pip install -r requirements-updated.txt

# –ò–ª–∏ –ø–æ –æ—Ç–¥–µ–ª—å–Ω–æ—Å—Ç–∏:
pip install pyrogram telethon tgcrypto
```

### –®–∞–≥ 2: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ API
```bash
# –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –æ–±–∞ –≤–∞—Ä–∏–∞–Ω—Ç–∞
python3 test-stars-api.py
```

### –®–∞–≥ 3: –í—ã–±—Ä–∞—Ç—å –ª—É—á—à–∏–π –≤–∞—Ä–∏–∞–Ω—Ç
```bash
# –ï—Å–ª–∏ Telethon —Ä–∞–±–æ—Ç–∞–µ—Ç –ª—É—á—à–µ:
python3 userbot-telethon.py

# –ï—Å–ª–∏ Pyrogram —Ä–∞–±–æ—Ç–∞–µ—Ç –ª—É—á—à–µ:
python3 userbot-agent-correct.py
```

---

## üìä –ü—Ä–∏–Ω—Ü–∏–ø —Ä–∞–±–æ—Ç—ã –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã

### 1. –ó–∞–≥—Ä—É–∑–∫–∞ –∫–∞—Ç–∞–ª–æ–≥–∞ –ø–æ–¥–∞—Ä–∫–æ–≤:
```python
result = await app.invoke(functions.payments.GetStarGifts())
# –ü–æ–ª—É—á–∞–µ–º —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –¥–æ—Å—Ç—É–ø–Ω—ã—Ö Star –ø–æ–¥–∞—Ä–∫–æ–≤
```

### 2. –ü–æ–∏—Å–∫ –ø–æ–¥—Ö–æ–¥—è—â–µ–≥–æ –ø–æ–¥–∞—Ä–∫–∞:
```python
def find_suitable_gift(self, stars_amount):
    # –ò—â–µ–º –ø–æ–¥–∞—Ä–æ–∫ —Å –Ω—É–∂–Ω—ã–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –∑–≤—ë–∑–¥
    suitable_gifts = [g for g in gifts if g.stars <= stars_amount]
    return max(suitable_gifts, key=lambda g: g.stars)
```

### 3. –°–æ–∑–¥–∞–Ω–∏–µ invoice:
```python
invoice = InputInvoiceStarGift(
    user_id=await app.resolve_peer(user_id),
    gift_id=suitable_gift.id
)
```

### 4. –û—Ç–ø—Ä–∞–≤–∫–∞ –ø–æ–¥–∞—Ä–∫–∞:
```python
# Pyrogram
payment_form = await app.invoke(functions.payments.GetPaymentForm(invoice=invoice))
result = await app.invoke(functions.payments.SendPaymentForm(...))

# Telethon  
result = await client(functions.payments.SendStarsFormRequest(...))
```

---

## üéØ –ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

1. **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—ã–≤–æ–¥–∏—Ç 25 –∑–≤—ë–∑–¥** ‚Üí —Å–∏—Å—Ç–µ–º–∞ –Ω–∞—Ö–æ–¥–∏—Ç –ø–æ–¥–∞—Ä–æ–∫ –Ω–∞ 25 –∑–≤—ë–∑–¥
2. **–°–∏—Å—Ç–µ–º–∞ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –ø–æ–¥–∞—Ä–æ–∫** ‚Üí –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–æ–ª—É—á–∞–µ—Ç **—Ä–µ–∞–ª—å–Ω—ã–π Telegram –ø–æ–¥–∞—Ä–æ–∫**
3. **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å** –ø–æ–¥–∞—Ä–æ–∫ –æ–±—Ä–∞—Ç–Ω–æ –≤ –∑–≤—ë–∑–¥—ã —á–µ—Ä–µ–∑ `payments.convertStarGift`

---

## ‚úÖ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω–æ–≥–æ API

### üéÅ –†–µ–∞–ª—å–Ω—ã–µ –ø–æ–¥–∞—Ä–∫–∏:
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –ø–æ–ª—É—á–∞—é—Ç **–Ω–∞—Å—Ç–æ—è—â–∏–µ Telegram –ø–æ–¥–∞—Ä–∫–∏**
- –ü–æ–¥–∞—Ä–∫–∏ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –≤ –ø—Ä–æ—Ñ–∏–ª–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- –ú–æ–∂–Ω–æ –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –æ–±—Ä–∞—Ç–Ω–æ –≤ –∑–≤—ë–∑–¥—ã

### üõ°Ô∏è –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:
- Telegram –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —ç—Ç–∏ –º–µ—Ç–æ–¥—ã
- –ú–µ–Ω—å—à–µ —Ä–∏—Å–∫ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –∞–∫–∫–∞—É–Ω—Ç–∞
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—É—é —Å—Ö–µ–º—É –ø–ª–∞—Ç–µ–∂–µ–π

### ‚ö° –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å:
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –≤—ã–±–æ—Ä –ø–æ–¥—Ö–æ–¥—è—â–µ–≥–æ –ø–æ–¥–∞—Ä–∫–∞
- –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–∞—Ç–∞–ª–æ–≥–∞ –ø–æ–¥–∞—Ä–∫–æ–≤
- –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã API:
```bash
python3 test-stars-api.py
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
```
‚úÖ Pyrogram: –ö–∞—Ç–∞–ª–æ–≥ –ø–æ–¥–∞—Ä–∫–æ–≤ –∑–∞–≥—Ä—É–∂–µ–Ω (X –ø–æ–¥–∞—Ä–∫–æ–≤)
‚úÖ Telethon: SendStarsFormRequest –¥–æ—Å—Ç—É–ø–µ–Ω!
```

### –¢–µ—Å—Ç —Ä–µ–∞–ª—å–Ω–æ–π –æ—Ç–ø—Ä–∞–≤–∫–∏:
1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –æ–¥–∏–Ω –∏–∑ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã—Ö –∞–≥–µ–Ω—Ç–æ–≤
2. –°–¥–µ–ª–∞–π—Ç–µ –≤—ã–≤–æ–¥ 15-25 –∑–≤—ë–∑–¥ —á–µ—Ä–µ–∑ –±–æ—Ç–∞  
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –Ω–∞ —É—Å–ø–µ—à–Ω—É—é –æ—Ç–ø—Ä–∞–≤–∫—É
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, –ø–æ–ª—É—á–∏–ª –ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–æ–¥–∞—Ä–æ–∫

---

## üéâ –ì–æ—Ç–æ–≤–æ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é!

**–°–∏—Å—Ç–µ–º–∞ —Ç–µ–ø–µ—Ä—å –±—É–¥–µ—Ç –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å —Ä–µ–∞–ª—å–Ω—ã–µ Telegram –ø–æ–¥–∞—Ä–∫–∏!** üéÅ

**–í—ã–±–µ—Ä–∏—Ç–µ –ª—É—á—à–∏–π –≤–∞—Ä–∏–∞–Ω—Ç:**
- **Telethon** ‚Üí –µ—Å–ª–∏ SendStarsFormRequest —Ä–∞–±–æ—Ç–∞–µ—Ç –∏–¥–µ–∞–ª—å–Ω–æ
- **Pyrogram** ‚Üí –µ—Å–ª–∏ –ø—Ä–µ–¥–ø–æ—á–∏—Ç–∞–µ—Ç–µ –±–æ–ª–µ–µ —Å—Ç–∞–±–∏–ª—å–Ω—É—é –±–∏–±–ª–∏–æ—Ç–µ–∫—É

**–ó–∞–ø—É—Å–∫–∞–π—Ç–µ –∏ —Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ! üöÄ**
