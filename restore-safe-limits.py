#!/usr/bin/env python3
"""
–í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –±–µ–∑–æ–ø–∞—Å–Ω—ã—Ö –ª–∏–º–∏—Ç–æ–≤ –¥–ª—è userbot
"""

import sqlite3
import os

def restore_safe_limits():
    """–í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –±–µ–∑–æ–ø–∞—Å–Ω—ã—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫"""
    
    print("üîß –í–û–°–°–¢–ê–ù–û–í–õ–ï–ù–ò–ï –ë–ï–ó–û–ü–ê–°–ù–´–• –ù–ê–°–¢–†–û–ï–ö\n")
    
    db_path = "userbot_queue.db"
    
    if not os.path.exists(db_path):
        print("‚ùå –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–µ –Ω–∞–π–¥–µ–Ω–∞")
        return False
    
    try:
        conn = sqlite3.connect(db_path)
        cursor = conn.cursor()
        
        # 1. –ü–æ–∫–∞–∑–∞—Ç—å —Ç–µ–∫—É—â–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
        print("üìä –¢–ï–ö–£–©–ò–ï –ù–ê–°–¢–†–û–ô–ö–ò:")
        cursor.execute("SELECT daily_limit, hourly_limit, max_amount FROM agent_settings WHERE id = 1")
        result = cursor.fetchone()
        
        if result:
            daily, hourly, max_amount = result
            print(f"   üìÖ –î–Ω–µ–≤–Ω–æ–π –ª–∏–º–∏—Ç: {daily} –∑–≤—ë–∑–¥")
            print(f"   ‚è∞ –ß–∞—Å–æ–≤–æ–π –ª–∏–º–∏—Ç: {hourly} –∑–≤—ë–∑–¥") 
            print(f"   üéØ –ú–∞–∫—Å–∏–º—É–º –∑–∞ —Ä–∞–∑: {max_amount} –∑–≤—ë–∑–¥")
            
            # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω—É–∂–Ω–æ –ª–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
            if daily > 100 or hourly > 20 or max_amount > 50:
                print("\n‚ö†Ô∏è –û–ü–ê–°–ù–´–ï –ù–ê–°–¢–†–û–ô–ö–ò –û–ë–ù–ê–†–£–ñ–ï–ù–´!")
                print("üö® –†–∏—Å–∫ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –∞–∫–∫–∞—É–Ω—Ç–∞!")
            else:
                print("\n‚úÖ –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –≤ –±–µ–∑–æ–ø–∞—Å–Ω—ã—Ö –ø—Ä–µ–¥–µ–ª–∞—Ö")
        else:
            print("   ‚ùå –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã")
        
        # 2. –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –±–µ–∑–æ–ø–∞—Å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è
        print("\nüõ°Ô∏è –í–û–°–°–¢–ê–ù–û–í–õ–ï–ù–ò–ï –ë–ï–ó–û–ü–ê–°–ù–´–• –õ–ò–ú–ò–¢–û–í:")
        
        safe_daily = 80    # –ë–µ–∑–æ–ø–∞—Å–Ω–æ –¥–ª—è –¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
        safe_hourly = 10   # –ù–µ –≤—ã–∑—ã–≤–∞–µ—Ç –ø–æ–¥–æ–∑—Ä–µ–Ω–∏–π —É Telegram
        safe_max = 25      # –¢–µ—Å—Ç-—Ä–µ–∂–∏–º –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
        
        cursor.execute("""
            UPDATE agent_settings 
            SET daily_limit = ?, hourly_limit = ?, max_amount = ?, updated_at = CURRENT_TIMESTAMP
            WHERE id = 1
        """, (safe_daily, safe_hourly, safe_max))
        
        # –ï—Å–ª–∏ –∑–∞–ø–∏—Å–∏ –Ω–µ—Ç, —Å–æ–∑–¥–∞—Ç—å –µ—ë
        if cursor.rowcount == 0:
            cursor.execute("""
                INSERT INTO agent_settings (id, daily_limit, hourly_limit, max_amount)
                VALUES (1, ?, ?, ?)
            """, (safe_daily, safe_hourly, safe_max))
        
        conn.commit()
        
        print(f"   ‚úÖ –î–Ω–µ–≤–Ω–æ–π –ª–∏–º–∏—Ç: {safe_daily} –∑–≤—ë–∑–¥ (–±—ã–ª–æ: {daily if result else '–Ω–µ –∑–∞–¥–∞–Ω–æ'})")
        print(f"   ‚úÖ –ß–∞—Å–æ–≤–æ–π –ª–∏–º–∏—Ç: {safe_hourly} –∑–≤—ë–∑–¥ (–±—ã–ª–æ: {hourly if result else '–Ω–µ –∑–∞–¥–∞–Ω–æ'})")
        print(f"   ‚úÖ –ú–∞–∫—Å–∏–º—É–º –∑–∞ —Ä–∞–∑: {safe_max} –∑–≤—ë–∑–¥ (–±—ã–ª–æ: {max_amount if result else '–Ω–µ –∑–∞–¥–∞–Ω–æ'})")
        
        # 3. –û—á–∏—Å—Ç–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –∑–∞ —Å–µ–≥–æ–¥–Ω—è (–¥–ª—è —Å–≤–µ–∂–µ–≥–æ —Å—Ç–∞—Ä—Ç–∞)
        print("\nüîÑ –°–ë–†–û–° –°–¢–ê–¢–ò–°–¢–ò–ö–ò:")
        cursor.execute("DELETE FROM stats_log WHERE date = DATE('now')")
        print("   ‚úÖ –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∑–∞ —Å–µ–≥–æ–¥–Ω—è —Å–±—Ä–æ—à–µ–Ω–∞")
        
        # 4. –ü–æ–∫–∞–∑–∞—Ç—å —Ñ–∏–Ω–∞–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
        print("\nüéØ –§–ò–ù–ê–õ–¨–ù–´–ï –ù–ê–°–¢–†–û–ô–ö–ò:")
        cursor.execute("SELECT daily_limit, hourly_limit, max_amount FROM agent_settings WHERE id = 1")
        final = cursor.fetchone()
        
        if final:
            daily, hourly, max_amount = final
            print(f"   üìÖ –õ–∏–º–∏—Ç –≤ –¥–µ–Ω—å: {daily} –∑–≤—ë–∑–¥")
            print(f"   ‚è∞ –õ–∏–º–∏—Ç –≤ —á–∞—Å: {hourly} –∑–≤—ë–∑–¥")
            print(f"   üéØ –ú–∞–∫—Å–∏–º—É–º –∑–∞ —Ä–∞–∑: {max_amount} –∑–≤—ë–∑–¥")
            print("   üß™ –¢–µ—Å—Ç-—Ä–µ–∂–∏–º: –í–ö–õ–Æ–ß–ï–ù")
            
        conn.close()
        
        print("\nüí° –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ò:")
        print("1. üîÑ –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ userbot –¥–ª—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –Ω–∞—Å—Ç—Ä–æ–µ–∫")
        print("2. üß™ –ù–∞—á–Ω–∏—Ç–µ —Å —Ç–µ—Å—Ç–æ–≤—ã—Ö —Å—É–º–º 5-15 –∑–≤—ë–∑–¥")
        print("3. üìä –°–ª–µ–¥–∏—Ç–µ –∑–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–æ–π –≤ –ª–æ–≥–∞—Ö")
        print("4. ‚è∞ –ù–µ –ø—Ä–µ–≤—ã—à–∞–π—Ç–µ –ª–∏–º–∏—Ç—ã ÔøΩÔøΩ–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏")
        
        print("\nüõ°Ô∏è –û–ë–™–Ø–°–ù–ï–ù–ò–ï –õ–ò–ú–ò–¢–û–í:")
        print("‚Ä¢ 80 –∑–≤—ë–∑–¥/–¥–µ–Ω—å - –±–µ–∑–æ–ø–∞—Å–Ω–æ –¥–ª—è –¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è")
        print("‚Ä¢ 10 –∑–≤—ë–∑–¥/—á–∞—Å - –Ω–µ –≤—ã–∑—ã–≤–∞–µ—Ç –ø–æ–¥–æ–∑—Ä–µ–Ω–∏–π —É Telegram")
        print("‚Ä¢ 25 –∑–≤—ë–∑–¥ –∑–∞ —Ä–∞–∑ - —Ç–µ—Å—Ç-—Ä–µ–∂–∏–º, –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —Ä–∏—Å–∫")
        print("‚Ä¢ –ó–∞–¥–µ—Ä–∂–∫–∏ 60-180 —Å–µ–∫ - –∏–º–∏—Ç–∞—Ü–∏—è —á–µ–ª–æ–≤–µ—á–µ—Å–∫–æ–≥–æ –ø–æ–≤–µ–¥–µ–Ω–∏—è")
        
        return True
        
    except Exception as e:
        print(f"‚ùå –û—à–∏–±–∫–∞: {e}")
        return False

if __name__ == "__main__":
    print("üõ°Ô∏è –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –±–µ–∑–æ–ø–∞—Å–Ω—ã—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫ userbot\n")
    
    result = restore_safe_limits()
    
    if result:
        print("\nüéâ –ù–ê–°–¢–†–û–ô–ö–ò –í–û–°–°–¢–ê–ù–û–í–õ–ï–ù–´!")
        print("üöÄ Userbot –≥–æ—Ç–æ–≤ –∫ –±–µ–∑–æ–ø–∞—Å–Ω–æ–π —Ä–∞–±–æ—Ç–µ")
    else:
        print("\n‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏")
