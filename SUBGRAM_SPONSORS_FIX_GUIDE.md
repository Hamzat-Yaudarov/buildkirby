# –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã —Å–æ —Å–ø–æ–Ω—Å–æ—Ä—Å–∫–∏–º–∏ –∫–∞–Ω–∞–ª–∞–º–∏ SubGram

## üö® –ü—Ä–æ–±–ª–µ–º–∞
–ë–æ—Ç –Ω–µ –≤–∏–¥–∏—Ç —Å–ø–æ–Ω—Å–æ—Ä—Å–∫–∏–µ –∫–∞–Ω–∞–ª—ã –æ—Ç SubGram - API –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç `linkedCount: 0`, –≤ –ª–æ–≥–∞—Ö –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç `—Å–ø–æ–Ω—Å–æ—Ä—ã 0 –∏–∑ 0`.

## üîç –ü—Ä–∏—á–∏–Ω—ã –ø—Ä–æ–±–ª–µ–º—ã

### 1. –ë–æ—Ç –Ω–µ –¥–æ–±–∞–≤–ª–µ–Ω –≤ SubGram –∏–ª–∏ –¥–æ–±–∞–≤–ª–µ–Ω –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ
- –ë–æ—Ç –Ω–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω –≤ SubGram
- –ë–æ—Ç –¥–æ–±–∞–≤–ª–µ–Ω –ë–ï–ó —Ç–æ–∫–µ–Ω–∞ (–¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –¥–æ–±–∞–≤–ª–µ–Ω –° –¢–û–ö–ï–ù–û–ú)
- –ù–µ–∞–∫—Ç–∏–≤–Ω—ã–π —Å—Ç–∞—Ç—É—Å –±–æ—Ç–∞ –≤ SubGram

### 2. –û—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç –ø—Ä–∞–≤–∞ –Ω–∞ –ø–æ–ª—É—á–µ–Ω–∏–µ –∫–∞–Ω–∞–ª–æ–≤
- ÔøΩÔøΩ–µ –≤–∫–ª—é—á–µ–Ω–∞ –æ–ø—Ü–∏—è "–ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–æ–Ω—Å–æ—Ä—Å–∫–∏—Ö –∫–∞–Ω–∞–ª–æ–≤"
- –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω—ã–µ –ø—Ä–∞–≤–∞ –±–æ—Ç–∞
- –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã–π API –∫–ª—é—á

### 3. –ù–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —Å–ø–æ–Ω—Å–æ—Ä—Å–∫–∏—Ö –∫–∞–Ω–∞–ª–æ–≤
- –í –¥–∞–Ω–Ω—ã–π –º–æ–º–µ–Ω—Ç –Ω–µ—Ç –∞–∫—Ç–∏–≤–Ω—ã—Ö —Ä–µ–∫–ª–∞–º–æ–¥–∞—Ç–µ–ª–µ–π
- –í—Å–µ –¥–æ—Å—Ç—É–ø–Ω—ã–µ –∫–∞–Ω–∞–ª—ã —É–∂–µ –æ–±—Å–ª—É–∂–∏–≤–∞—é—Ç—Å—è
- –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã –Ω–∞ —Å—Ç–æ—Ä–æ–Ω–µ SubGram

## üõ†Ô∏è –†–µ—à–µ–Ω–∏—è

### –†–µ—à–µ–Ω–∏–µ 1: –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –≤ SubGram

1. **–ó–∞–π–¥–∏—Ç–µ –Ω–∞ https://subgram.ru**
2. **–í–æ–π–¥–∏—Ç–µ –≤ –∞–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å**
3. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å –±–æ—Ç–∞:**
   - –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –±–æ—Ç –¥–æ–±–∞–≤–ª–µ–Ω
   - –°—Ç–∞—Ç—É—Å –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å "–ê–∫—Ç–∏–≤–µ–Ω"
   - **–í–ê–ñ–ù–û: –ë–æ—Ç –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –¥–æ–±–∞–≤–ª–µ–Ω "–° –¢–û–ö–ï–ù–û–ú"**

4. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:**
   - –í–∫–ª—é—á–∏—Ç–µ "–ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–æ–Ω—Å–æ—Ä—Å–∫–∏—Ö –∫–∞–Ω–∞–ª–æ–≤"
   - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–∏–º–∏—Ç—ã –∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è
   - –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ API –∫–ª—é—á –∞–∫—Ç—É–∞–ª–µ–Ω

### –†–µ—à–µ–Ω–∏–µ 2: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –≤ –±–æ—Ç–µ

–í—ã–ø–æ–ª–Ω–∏—Ç–µ —Å–∫—Ä–∏–ø—Ç –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏:
```bash
node fix-subgram-sponsor-channels.js
```

–ò–ª–∏ —á–µ—Ä–µ–∑ –∞–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å –±–æ—Ç–∞:
- –ê–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å ‚Üí SubGram —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ ‚Üí üö® –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ —Å–ø–æ–Ω—Å–æ—Ä–æ–≤

### –†–µ—à–µ–Ω–∏–µ 3: –í—Ä–µ–º–µ–Ω–Ω–æ–µ –æ—Ç–∫–ª—é—á–µ–Ω–∏–µ SubGram

–ï—Å–ª–∏ –ø—Ä–æ–±–ª–µ–º–∞ –∫—Ä–∏—Ç–∏—á–Ω–∞ –∏ –Ω—É–∂–Ω–æ —á—Ç–æ–±—ã –±–æ—Ç —Ä–∞–±–æ—Ç–∞–ª:

```sql
UPDATE subgram_settings SET enabled = false;
```

–ò–ª–∏ —á–µ—Ä–µ–∑ –∞–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å:
- –ê–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å ‚Üí SubGram —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ ‚Üí –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ —Å–ø–æ–Ω—Å–æ—Ä–æ–≤ ‚Üí –û—Ç–∫–ª—é—á–∏—Ç—å SubGram

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ë–æ—Ç –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å —Ç–æ–ª—å–∫–æ —Å –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–º–∏ –∫–∞–Ω–∞–ª–∞–º–∏.

### –†–µ—à–µ–Ω–∏–µ 4: –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã—Ö –∫–∞–Ω–∞–ª–æ–≤

–ï—Å–ª–∏ —Å–ø–æ–Ω—Å–æ—Ä—Å–∫–∏–µ –∫–∞–Ω–∞–ª—ã –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã, –¥–æ–±–∞–≤—å—Ç–µ –±–æ–ª—å—à–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã—Ö:

```sql
INSERT INTO required_channels (channel_id, channel_name, is_active) 
VALUES ('@your_channel', '–ù–∞–∑–≤–∞–Ω–∏–µ –∫–∞–Ω–∞–ª–∞', true);
```

–ò–ª–∏ —á–µ—Ä–µ–∑ –∞–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å:
- –ê–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å ‚Üí –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –∫–∞–Ω–∞–ª—ã ‚Üí –î–æ–±–∞–≤–∏—Ç—å –∫–∞–Ω–∞–ª

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –¢–µ—Å—Ç 1: –ü—Ä–æ–≤–µ—Ä–∫–∞ API
```bash
node test-subgram-with-db.js
```

### –¢–µ—Å—Ç 2: –î–∏–∞ÔøΩÔøΩ–Ω–æ—Å—Ç–∏–∫–∞ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏
```bash
node debug-subgram-status.js
```

### –¢–µ—Å—Ç 3: –ß–µ—Ä–µ–∑ –∞–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å
- –ê–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å ‚Üí SubGram —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ ‚Üí üß™ –¢–µ—Å—Ç –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–æ–≤
```sql
SELECT * FROM subgram_api_requests 
WHERE created_at > NOW() - INTERVAL '1 hour'
ORDER BY created_at DESC;
```

### –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –æ—à–∏–±–æ–∫
```sql
SELECT 
    COUNT(*) as total_requests,
    COUNT(CASE WHEN success = true THEN 1 END) as successful_requests,
    COUNT(CASE WHEN success = false THEN 1 END) as failed_requests
FROM subgram_api_requests 
WHERE created_at > NOW() - INTERVAL '24 hours';
```

## üîß –ë—ã—Å—Ç—Ä—ã–µ –∫–æ–º–∞–Ω–¥—ã

### –í–∫–ª—é—á–∏—Ç—å SubGram
```sql
UPDATE subgram_settings SET enabled = true;
```

### –û—Ç–∫–ª—é—á–∏—Ç—å SubGram
```sql
UPDATE subgram_settings SET enabled = false;
```

### –û–±–Ω–æ–≤–∏—Ç—å API –∫–ª—é—á
```sql
UPDATE subgram_settings SET api_key = '–≤–∞—à_–Ω–æ–≤—ã–π_–∫–ª—é—á';
```

### –£–≤–µ–ª–∏—á–∏—Ç—å –ª–∏–º–∏—Ç —Å–ø–æ–Ω—Å–æ—Ä–æ–≤
```sql
UPDATE subgram_settings SET max_sponsors = 5;
```

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

### SubGram –ø–æ–¥–¥–µ—Ä–∂–∫–∞
- –°–∞–π—Ç: https://subgram.ru
- –ü—Ä–∏ –æ–±—Ä–∞—â–µ–Ω–∏–∏ —É–∫–∞–∂–∏—Ç–µ:
  - –í–∞—à API –∫–ª—é—á
  - –û–ø–∏—Å–∞ÔøΩÔøΩ–∏–µ –ø—Ä–æ–±–ª–µ–º—ã
  - –õ–æ–≥–∏ –æ—à–∏–±–æ–∫

### –í–Ω—É—Ç—Ä–µ–Ω–Ω—è—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞
- `/admin_subgram_sponsors_diagnostic` - –ø–æ–ª–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞
- `/admin_subgram_test` - —Ç–µ—Å—Ç API
- `/admin_subgram_logs` - –ø—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤

## üìà –†–µ–∑—É–ª—å—Ç–∞—Ç

–ü–æ—Å–ª–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π:
- –°–ø–æ–Ω—Å–æ—Ä—Å–∫–∏–µ –∫–∞–Ω–∞–ª—ã –¥–æ–ª–∂–Ω—ã –ø–æ—è–≤–∏—Ç—å—Å—è –≤ –±–æ—Ç–µ
- –õ–æ–≥–∏ –ø–æ–∫–∞–∂—É—Ç `—Å–ø–æ–Ω—Å–æ—Ä—ã X –∏–∑ X` –≥–¥–µ X > 0
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –±—É–¥—É—Ç –≤–∏–¥–µ—Ç—å —ç—Ç–∞–ø "–°–ø–æ–Ω—Å–æ—Ä—Å–∫–∏–µ –∫–∞–Ω–∞–ª—ã"

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è

1. **–ë–æ—Ç –î–û–õ–ñ–ï–ù –±—ã—Ç—å –¥–æ–±–∞–≤–ª–µ–Ω –≤ SubGram –° –¢–û–ö–ï–ù–û–ú**
2. **–ï—Å–ª–∏ —Å–ø–æ–Ω—Å–æ—Ä–æ–≤ –Ω–µ—Ç - —ç—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ, –±–æ—Ç –ø—Ä–æ–¥–æ–ª–∂–∏—Ç —Ä–∞–±–æ—Ç–∞—Ç—å**
3. **–û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –∫–∞–Ω–∞–ª—ã –≤—Å–µ–≥–¥–∞ —Ä–∞–±–æ—Ç–∞—é—Ç –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç SubGram**
4. **Fallback —Å–∏—Å—Ç–µ–º–∞ –æ–±–µ—Å–ø–µ—á–∏—Ç —Ä–∞–±–æ—Ç—É –¥–∞–∂–µ –ø—Ä–∏ –ø—Ä–æ–±–ª–µ–º–∞—Ö —Å API**
